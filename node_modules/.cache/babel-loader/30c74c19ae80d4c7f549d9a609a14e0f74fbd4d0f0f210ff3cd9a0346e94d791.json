{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Kwell/Documents/GitHub/react-project-1/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Kwell/Documents/GitHub/react-project-1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/Kwell/Documents/GitHub/react-project-1/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Kwell/Documents/GitHub/react-project-1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{userAPI}from\"../api/api\";import{updateObjectInArray}from\"../componnents/utils/object-helpers\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:10,totalUsersCount:21,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:true})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:false})});case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:action.users});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});}case SET_TOTAL_USERS_COUNT:{return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.count});}case TOGGLE_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case TOGGLE_IS_FOLLOWING_PROGRESS:{return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!==action.userId;})});}default:return state;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(count){return{type:SET_TOTAL_USERS_COUNT,count:count};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(page,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(page));_context.next=4;return userAPI.getUsers(page,pageSize);case 4:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var followUnfollowFlow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch,userId,apiMethod,actionCreator){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return apiMethod(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(actionCreator(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function followUnfollowFlow(_x2,_x3,_x4,_x5){return _ref2.apply(this,arguments);};}();export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:followUnfollowFlow(dispatch,userId,userAPI.follow.bind(userAPI),followSuccess);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x6){return _ref3.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:followUnfollowFlow(dispatch,userId,userAPI.unfollow.bind(userAPI),unfollowSuccess);case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x7){return _ref4.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"names":["userAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","userId","followed","count","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","toggleFollowingProgress","requestUsers","page","dispatch","getUsers","data","items","totalCount","followUnfollowFlow","apiMethod","actionCreator","response","resultCode","follow","bind","unfollow"],"sources":["C:/Users/Kwell/Documents/GitHub/react-project-1/src/redux/users-reducer.js"],"sourcesContent":["import {userAPI} from \"../api/api\";\r\nimport {updateObjectInArray} from \"../componnents/utils/object-helpers\";\r\n\r\nconst FOLLOW = 'FOLLOW';\r\nconst UNFOLLOW = 'UNFOLLOW';\r\nconst SET_USERS = 'SET_USERS';\r\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\r\nconst SET_TOTAL_USERS_COUNT = 'SET_TOTAL_USERS_COUNT';\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS';\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 10,\r\n    totalUsersCount: 21,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    followingInProgress: []\r\n}\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, action.userId, \"id\", {followed: true} )\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, action.userId, \"id\", {followed: false} )\r\n            }\r\n        case SET_USERS: {\r\n            return {...state, users: action.users}\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalUsersCount: action.count}\r\n        }\r\n        case TOGGLE_IS_FETCHING: {\r\n            return {...state, isFetching: action.isFetching}\r\n        }\r\n        case TOGGLE_IS_FOLLOWING_PROGRESS: {\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching\r\n                    ? [...state.followingInProgress, action.userId]\r\n                    : state.followingInProgress.filter(id => id !== action.userId)\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const followSuccess = (userId) => ({type: FOLLOW, userId})\r\nexport const unfollowSuccess = (userId) => ({type: UNFOLLOW, userId})\r\nexport const setUsers = (users) => ({type: SET_USERS, users})\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport const setTotalUsersCount = (count) => ({type: SET_TOTAL_USERS_COUNT, count})\r\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\r\nexport const toggleFollowingProgress = (isFetching, userId) => ({\r\n    type: TOGGLE_IS_FOLLOWING_PROGRESS,\r\n    isFetching,\r\n    userId\r\n})\r\n\r\nexport const requestUsers = (page, pageSize) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleIsFetching(true));\r\n        dispatch(setCurrentPage(page))\r\n\r\n        let data = await userAPI.getUsers(page, pageSize)\r\n        dispatch(toggleIsFetching(false));\r\n        dispatch(setUsers(data.items));\r\n        dispatch(setTotalUsersCount(data.totalCount));\r\n    }\r\n}\r\nexport const followUnfollowFlow = async (dispatch, userId, apiMethod, actionCreator) => {\r\n    dispatch(toggleFollowingProgress(true, userId));\r\n    let response = await apiMethod(userId)\r\n    if (response.data.resultCode === 0) {\r\n        dispatch(actionCreator(userId));\r\n    }\r\n    dispatch(toggleFollowingProgress(false, userId));\r\n}\r\n\r\nexport const follow = (userId) => {\r\n    return async (dispatch) => {\r\n        followUnfollowFlow(dispatch, userId, userAPI.follow.bind(userAPI), followSuccess)\r\n    }\r\n}\r\nexport const unfollow = (userId) => {\r\n    return async (dispatch) => {\r\n        followUnfollowFlow(dispatch, userId, userAPI.unfollow.bind(userAPI), unfollowSuccess)\r\n    }\r\n}\r\n\r\nexport default usersReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}